function startApp(){const t=window.location.host,e=window.location.pathname,s=new Terminal({cursorBlink:!0,macOptionIsMeta:!0,scrollback:!0}),n=window.location.protocol.indexOf("https")?"ws":"wss",o=new WebSocket(`${n}://${t}${e}pty`);function i(){s.fit(),o.send(JSON.stringify({action:"resize",data:{cols:s.cols,rows:s.rows}}))}window.onresize=function(t,e){let s;return function(...n){const o=this;clearTimeout(s),s=setTimeout(()=>t.apply(o,n),e)}}(i,50),o.onopen=function(){s.open(document.getElementById("webpty")),s.toggleFullScreen(!0),s.setOption("scrollback",5e3),i()},o.onmessage=function(t){s.write(t.data)},s.on("key",t=>{o.send(JSON.stringify({action:"input",data:{key:t}}))}),s.on("paste",t=>{o.send(JSON.stringify({action:"input",data:{key:t}}))}),KEEP_ALIVE&&setInterval(function(){o.send(JSON.stringify({action:"ping"}))},1e3*KEEP_ALIVE)}function getPasswordFromCookie(){const t=`; ${document.cookie}`.split("; webptyPass=");if(2===t.length)return t.pop().split(";").shift()}if(Terminal.applyAddon(fullscreen),Terminal.applyAddon(fit),Terminal.applyAddon(webLinks),APP_SECURED)for(var userPassword=getPasswordFromCookie();null===userPassword||""===userPassword||void 0===userPassword;)if(userPassword=prompt("This is a password protected shell. Please enter your password.")){var xhr=new XMLHttpRequest;xhr.open("POST","/auth",!0),xhr.setRequestHeader("Content-Type","application/json"),xhr.send(JSON.stringify({webptyPass:userPassword})),xhr.onreadystatechange=function(){4==this.readyState&&(200!==this.status&&(userPassword=null),200===this.status&&location.reload())}}startApp();